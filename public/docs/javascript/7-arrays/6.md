---
id: javascript-arrays-6
title: 高階関数によるイテレーション
level: 2
---

## 高階関数によるイテレーション

JavaScriptでは、`for`文や`while`文を書く頻度は減っています。代わりに、配列のメソッドとして提供される**高階関数**（関数を引数に取る関数）を使用して、処理の意図（変換、抽出、集約など）を明確にします。

主なメソッドは以下の通りです。

  * **`forEach`**: 単なる反復処理（戻り値なし）。副作用（ログ出力やDB保存など）を起こすために使う。
  * **`map`**: 全要素を変換し、**新しい配列**を返す。
  * **`filter`**: 条件に一致する要素のみを抽出し、**新しい配列**を返す。
  * **`reduce`**: 要素を一つずつ処理して、**単一の値**（合計、オブジェクトなど）に集約する。

以下は、これらのメソッドを使って商品リストを処理するスクリプトです。

```js:shopping_cart.js
const cart = [
  { id: 1, name: 'Laptop', price: 1000, category: 'Electronics' },
  { id: 2, name: 'Mouse', price: 25, category: 'Electronics' },
  { id: 3, name: 'Coffee', price: 5, category: 'Food' },
  { id: 4, name: 'Keyboard', price: 100, category: 'Electronics' },
];

console.log('--- 1. map: 商品名のリストを作成 ---');
const itemNames = cart.map(item => item.name);
console.log(itemNames);

console.log('\n--- 2. filter: 電子機器(Electronics)のみ抽出 ---');
const electronics = cart.filter(item => item.category === 'Electronics');
console.log(electronics);

console.log('\n--- 3. reduce: 合計金額を計算 ---');
// 第2引数の 0 はアキュムレータ(sum)の初期値
const totalPrice = cart.reduce((sum, item) => sum + item.price, 0);
console.log(`Total: $${totalPrice}`);

console.log('\n--- 4. メソッドチェーン（組み合わせ） ---');
// 電子機器の価格のみを抽出して合計する
const electronicsTotal = cart
  .filter(item => item.category === 'Electronics')
  .map(item => item.price)
  .reduce((acc, price) => acc + price, 0);

console.log(`Electronics Total: $${electronicsTotal}`);
```

実行結果:

```js-exec:shopping_cart.js
--- 1. map: 商品名のリストを作成 ---
[ 'Laptop', 'Mouse', 'Coffee', 'Keyboard' ]

--- 2. filter: 電子機器(Electronics)のみ抽出 ---
[
  { id: 1, name: 'Laptop', price: 1000, category: 'Electronics' },
  { id: 2, name: 'Mouse', price: 25, category: 'Electronics' },
  { id: 4, name: 'Keyboard', price: 100, category: 'Electronics' }
]

--- 3. reduce: 合計金額を計算 ---
Total: $1130

--- 4. メソッドチェーン（組み合わせ） ---
Electronics Total: $1125
```

> **Note:** `map`や`filter`は元の配列を変更せず（イミュータブル）、新しい配列を返します。これにより、予期せぬ副作用を防ぐことができます。

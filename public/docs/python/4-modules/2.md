---
id: python-modules-2
title: 自作モジュールの作成と利用
level: 3
---

### 自作モジュールの作成と利用

自分でモジュールを作成するのも簡単です。関連する関数をまとめた `.py` ファイルを作成するだけです。ここからは複数のファイルが必要になるため、再びスクリプトファイルで説明します。

1.  **`utils.py` の作成**:
    まず、便利な関数をまとめた `utils.py` というファイルを作成します。

    ```python:utils.py
    def say_hello(name):
        """指定された名前で挨拶を返す"""
        return f"Hello, {name}!"

    def get_list_average(numbers):
        """数値リストの平均を計算する"""
        if not numbers:
            return 0
        return sum(numbers) / len(numbers)

    # このファイルが直接実行された場合にのみ以下のコードを実行
    if __name__ == "__main__":
        print("This is a utility module.")
        print(say_hello("World"))
        avg = get_list_average([10, 20, 30])
        print(f"Average: {avg}")
    ```

    ```python-exec:utils.py
    This is a utility module.
    Hello, World!
    Average: 20.0
    ```

    > **`if __name__ == "__main__":` の重要性**
    > この記述はPythonの定型句です。

    >   * スクリプトが**直接実行された**場合、そのスクリプトの `__name__` という特殊変数は `"__main__"` になります。
    >   * スクリプトが**モジュールとして `import` された**場合、`__name__` はファイル名（この場合は `"utils"`）になります。
    >     これにより、モジュールとしてインポートされた際には実行したくないテストコードやデモコードを記述することができます。他言語経験者にとっては、プログラムの「エントリーポイント」を定義する `main` 関数のような役割と考えると分かりやすいでしょう。

2.  **`main.py` からの利用**:
    次に、`utils.py` と同じディレクトリに `main.py` を作成し、`utils` モジュールをインポートして使います。

    ```python:main.py
    # 自作のutilsモジュールをインポート
    import utils

    greeting = utils.say_hello("Alice")
    print(greeting)

    scores = [88, 92, 75, 100]
    average_score = utils.get_list_average(scores)
    print(f"Your average score is: {average_score}")
    ```

    ```python-exec:main.py
    Hello, Alice!
    Your average score is: 88.75
    ```

このように、機能ごとにファイルを分割することで、コードの見通しが良くなり、再利用も簡単になります。

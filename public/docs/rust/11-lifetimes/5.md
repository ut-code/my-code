---
id: rust-lifetimes-5
title: 構造体定義におけるライフタイム注釈
level: 2
---

## 構造体定義におけるライフタイム注釈

これまでの章では、構造体には `String` や `i32` などの「所有される型」を持たせてきました。
しかし、構造体に**参照**を持たせたい場合もあります。その場合、**「構造体そのものよりも、中の参照先が長生き（あるいは同等の寿命）である」**ことを保証しなければなりません。

```rust:struct_lifetime.rs
// ImportantExcerpt構造体は、'a という期間だけ生きる文字列スライスを保持する
struct ImportantExcerpt<'a> {
    part: &'a str,
}

fn main() {
    let novel = String::from("Call me Ishmael. Some years ago...");
    
    // 最初の文（ピリオドまで）を取得
    let first_sentence = novel.split('.').next().expect("Could not find a '.'");
    
    // 構造体のインスタンスを作成
    // part は novel の一部を参照している。
    // novel が有効である限り、i も有効であることが保証される。
    let i = ImportantExcerpt {
        part: first_sentence,
    };

    println!("Novel start: {}", i.part);
}
```

```rust-exec:struct_lifetime.rs
Novel start: Call me Ishmael
```

もし `User` 構造体のような定義で `<'a>` を忘れると、「参照を持たせるならライフタイムを指定せよ」というエラーになります。これは、構造体が生きている間に参照先のデータが消えてしまうのを防ぐためです。

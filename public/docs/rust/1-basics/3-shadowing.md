---
id: rust-basics-3-shadowing
title: シャドーイング（Shadowing）
level: 2
---

## シャドーイング（Shadowing）

Rustには、他の言語ではあまり見られない**シャドーイング（Shadowing）という強力な機能があります。これは、同じ名前の変数を `let` を使って再宣言**することで、前の変数を「覆い隠す」機能です。

`mut` との違いは2点あります：

1.  **型を変更できる**: `mut` は値の変更しかできませんが、シャドーイングは新しい変数を宣言しているのと同じなので、型を変えることができます。
2.  **不変に戻る**: 処理が終わった後、その変数は再び不変（immutable）になります。

<!-- end list -->

```rust:shadowing.rs
fn main() {
    let x = 5;
    
    // 最初のシャドーイング: 値を加工する
    let x = x + 1;

    {
        // 内側のスコープでのシャドーイング
        let x = x * 2;
        println!("内側のスコープでのx: {}", x);
    }

    // スコープを抜けると、外側のxの値が参照される
    println!("外側のスコープでのx: {}", x);

    // 型の変更を伴うシャドーイングの例
    let spaces = "   "; // 文字列スライス型
    let spaces = spaces.len(); // usize型（整数）
    
    println!("スペースの数: {}", spaces);
}
```

```rust-exec:shadowing.rs
内側のスコープでのx: 12
外側のスコープでのx: 6
スペースの数: 3
```

他言語では `spaces_str`、`spaces_num` のように変数名を変える場面でも、Rustでは変数の意味が変わらなければ同じ名前を再利用してコードをすっきり保つことができます。

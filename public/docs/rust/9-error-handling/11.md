---
id: rust-error-handling-11
title: '練習問題 2: データ処理チェーン（エラー伝播）'
level: 3
---

### 練習問題 2: データ処理チェーン（エラー伝播）

文字列形式の数値（例: "10,20,30"）を受け取り、カンマ区切りの最初の数値を2倍にして返す関数 `process_csv_data` を作成してください。

  * 以下の手順を行い、途中でエラーがあれば `?` 演算子などを使って伝播させてください。
    1.  文字列をカンマ `,` で分割し( `split` メソッド)、最初の要素を取得する（要素がない場合はエラー）。
    2.  取得した文字列を `i32` にパースする( `parse` メソッド)（パース失敗はエラー）。
    3.  数値を2倍して返す。
  * 関数の戻り値は `Result<i32, String>` とします（エラー型の変換が必要な場合は `map_err` を活用してください）。

<!-- end list -->

```rust:practice10_2.rs
fn process_csv_data(csv: &str) -> Result<i32, String> {


}

fn main() {
    let inputs = ["10,20,30", "abc,20", "", "  ,50"];

    for input in inputs {
        print!("Input: {:<10} => ", format!("\"{}\"", input));
        match process_csv_data(input) {
            Ok(n) => println!("結果: {}", n),
            Err(e) => println!("エラー: {}", e),
        }
    }
}
```

```rust-exec:practice10_2.rs
Input: "10,20,30" => 結果: 20
Input: "abc,20"   => エラー: 'abc' は数値ではありません
Input: ""         => エラー: 要素が空です
Input: "  ,50"    => エラー: 要素が空です
```
